# 운영체제 보안

## 11.1 보안의 개요

### 11.1.1 보호와 보안

1. 컴퓨터 시스템 보호
    - 각 프로세스가 프로세스를 점유하는 시간, 사용하는 자료, 자료가 관리되는 작업, 점유하는 장치 등을 대상으로 컴퓨터 시스템 내부 자원 각각의 영역을 보장해 주는 것
2. 컴퓨터 시스템 보안
    - 원거리에서 접근하는 사용자들에 대해서도 패스워드 등의 인증 메커니즘과 암호화 메커니즘 등을 통하여 합법적인 처리만 이루어지도록 보장하여 시스템과 그 시스템 내의 자료가 결함이 없도록 보존하고 신뢰성을 유지하는 기법
3. 보호와 보안의 목적
    - 사용자가 자원에 대한 접근 제한을 의도적으로 위반하는 것을  방지
    - 주변 시스템 간의 인터페이스에서의 잠재적인 오류를 검출함으로써 시스템의 신뢰도를 증가
    - 시스템의 자원들이 무자격 사용자에 의하여 잘못 사용되는 것을 방지
    - 권한이 있는 사용자와 권한이 없는 사용자를 구별하는 수단을 제공
    - 시스템 프로세스들과 사용자 프로세스들의 관계 및 시스템이 관리하는 자료와 사용자가 관리하는 자료에 대한 접근 제어를 규정하기 위한 작업

### 11.1.2 보호영역

1. 보호영역
    - 한 프로세스가 접근할 수 있는 자원
    - 각각의 영역은 객체의 집합과 그 객체에서 취할 수 있는 조작의 형태를 정의
    - 하나의 영역은 접근권한의 집합
2. 접근권한
    - 프로세스가 객체에 대한 조작을 수행할 수 있는 능력
    - <객체 이름, 권한 집합>

### 11.1.3 운영체제 보안

1. 운영체제 보안
    - 운영체제상에 내재된 보안상의 결함을 이용해서 발생할 수 있는 각종 공격으로부터 운영체제상의 자원에 대한 불법적인 수정이나 참조를 방지하는 정책과 기법
    - 모든 자원들이 분산된 다수의 사용자 시스템 및 통신망을 통해 접근되기 때문에 이들 자원들에 대한 안정성을 보장하는 것이 가장 중요한 문제
2. **운영체제 보안의 기본 목표**
    - **기밀성** : 운영체제 자원의 **부적절한 노출을 예방하고 감지**
    - **가용성** : 모든 주제는 **합법**적인 경우에는 항상 **객체에 접근이 가능**해야 함
    - **무결성** : **비인가된 주체**에 의한 자원의 생성, 변경, 삭제 등으로부터 **자원을 보호**
3. **정보 침해**
    - 안전하게 유지되어야 할 정보에 대해서 **불법적인 참조나 변조**가 가해지는 것
    - **고의적 침해** : 운영체제의 사용자 신분 확인 기능이 미약하여 고의적으로 다른 사용자의 사용권한을 도용하는 경우
    - **우연한 상황의 침해** : 운영체제 **내부의 결함이나 기능 부족**으로 인하여 보호영역의 통제가 정확하게 되지 못하여 우연히 **다른 사용자의 영역을 침범**하게 되는 경우
4. **정보 침해 위협요소**
    - 흐름 차단 : 시스템의 일부가 파괴되거나 **사용할 수 없게 된 상태**(가용성 위협)
    - 변조 : 인가받지 않은 제3자가 자원에 접근하여 **내용을 변경**하는 경우(기밀성 위협)
    - 위조 : 인가 받지 않은 제3자가 운영체제 내에 **위조물을 삽입**하는 경우(무결성 위협)
5. 운영체제를 통한 침해 유형
    - 트로이 목마 : 사용자가 감염된 프로그램을 실행하게 함으로써 사용자가 가지고 있는 합법적 권한을 사용하여 시스템 방어체제에 침입함으로써 정보를 유출하거나 손상하는 피해를 입힘(자가 복제 능력 없음)
    - 트랩 도어 : 고의로 만들어 놓은 시스템의 보안이 제거된 비밀통로. 정상적인 인증 절차를 우회하거나 원격 접속 등의 행동을 할 수 있게 함
    - 비밀 채널 : 중요한 정보나 자료를 얻어내기 위해 정상적인 데이터 전송 메커니즘이 아닌 비밀 통로를 만드는 것
    - 웜 : 스스로 복제를 함으로써 다른 컴퓨터로 자신의 복사본을 널리 퍼트리는 악성코드
    - 바이러스 : 다른 프로그램에 감염이 되어 전파되는 악성코드

## 11.2 보안 정책 및 보안 메커니즘

1. 보안 정책
    - 보호를 **어떠한 관점**에서 무엇을 행할 것인가를 결정
    - 인증 및 식별, 접근제어, 능동적 침입 방지, 시스템 관리
2. 보안 메커니즘
    - 보호를 **어떠한 방법**으로 할 것인가를 결정
    - 암호, 인증, 보안등급 관리 등

### 11.2.1 보안 정책

1. 권한 부여(authorization)
    - 어떤 객체를 **어떻게 엑세스할 수 있는지를 결정**
    - 모든 주체(프로세스)와 객체(자원)는 식별 및 인증이 가능해야 함
        - 식별(identification) : 신분을 알아내는 것(id)
        - 인증(authentication) : 정말 그 주체와 객체가 맞는지 확인하는 것(password)
    - 주체와 객체에 대한 접근 제어 및 보안 등급 부여를 가능하게 함
2. **임의적 접근제어**(DAC, Discretionary Access Control)
    - **개별 사용자**가 보안 관리자의 개입 없이 자율적 판단에 따라 보유하고 있는 자원의 **접근권한을 다른 사용자에게 부여**하는 기법
    - 자원의 보호보다 자원의 공유가 중요할 때 적합
    - 장점 : 유연하게 자원을 공유할 수 있음
    - 단점 : 관리가 쉽지 않음
        - 누가 권한을 가지고 있는지 판단 어려움
3. **강제적 접근제어**(MAC, Mandatory Access Control)
    - 각 주체가 **객체에 접근할 때마다 사전에 규정된 규칙과 비교**하여 그 **규칙을 만족하는 주체에게만 접근 권한**을 부여
    - 접근 요청이 올 때 마다 허가 등급과 비밀 등급을 비교하여 허가 여부를 결정
    - 보안 관리자가 시스템 전체에 대한 보안 정책을 구현하고 강제
        - 각 사용자는 이 정책을 넘어서는 행동을 할 수 없음
    - 임의적 접근제어와 강제적 접근제어는 반대의 관계가 성립한다고 볼 수도 있다.
    - 장점 : **관리가 확실함**
    - 단점 : **자원의 공유가 어려움**
4. **역할 기반 접근제어**(RBAC, Role Based Access Control)
    - 권한은 역할과 관련이 있으며, 사용자들은 **역할의 한 멤버가 됨**으로써 권한을 배정받게 됨
    - 주체는 역할이 주어졌을 때, 그리고 그 역할에 권한이 주어졌을 때만 권한 사용 가능
    
    ![image](https://github.com/myrhymetree/operating-system/assets/94158097/273a72d9-11f5-4f91-be82-7534c6f4bd91)
    
5. **최소권한**
    - 사용자 또는 프로세스는 특정 업무를 수행하는데 필요한 최소한의 제한적인 권한만을 할당 받아야 하고, 이들 권한은 **특정 업무를 수행하는 동안에만 할당**됨
6. 감사(auditing)
    - 컴퓨터 시스템에 발생한 모든 중요한 산건의 영구적인 기록
    - 사건이 발생하면 즉시 자동적으로 시스템의 안전한 곳에 기록됨
    - 감사 과정을 통해 로그 파일을 조사하여 발생한 이벤트를 추적하고 침해 사고 등이 발생했는지 여부를 확인하고 감시해야 함
    - 참고 : [https://itwiki.kr/w/윈도우_감사_정책](https://itwiki.kr/w/%EC%9C%88%EB%8F%84%EC%9A%B0_%EA%B0%90%EC%82%AC_%EC%A0%95%EC%B1%85)

### 11.2.2 보안 메커니즘

1. 주체 및 객체의 레이블 부여 메커니즘
    - 유일한 식별자를 부여하여 서로 구별이 가능하게 함
    - 보안등급을 부여하여 허락되지 않은 접근을 막음
    - 강제적 접근제어를 구현하는데 필요
2. 안전한 암호 메커니즘
    - 비밀키 암호 알고리즘과 공개키 암호 알고리즘
    - 서로 다른 특징으로 사용되는 분야가 다름
3. 패스워드 시스템을 비롯한 안전한 인증 메커니즘
    - 패스워드 : 가장 간단한 방법
        - 수정이나 찰취를 막기 위해 암호화 하여 저장
    - 다요소 인증 : 사용자 인증에 둘 이상의 방법 요구
4. 임의적 접근제어를 위한 메커니즘
    - UNIX 예 : 파일 소유자가 각 파일마다 자신, 자신이 속한 그룹, 나머지에 대해 읽기, 쓰기, 실행 권한을 부여 가능
        - r w x | r w x | - - x : 자신, 그룹은 읽기, 쓰기, 실행 가능. 나머지는 실행만 가능
        - r w x | - - - | - - - : 자신만 권한 주고 그룹,나머지는 권한 없음
    - 접근 제어 리스트(ACL, Access Control List) 사용
        - 프로세스 A는 모든 권한, 프로세스 B는 읽기 권한만, C는 읽기, 쓰기 권한 주기 등 세세한 권한 컨트롤 가능
5. 보안등급 관리 메커니즘
    - 사용자에개 다양한 종류의 보안등급 부여
    - 체계적이고 안전한 방법으로 관리되어야 함
6. 기록 파일 관리 메커니즘
    - 로그를 수정하지 못하게 접근제어와 암호화를 통해 안전하게 보관
7. 운영자 권한의 분산 메커니즘
    - 시스템 관리자의 권한을 세분화하여 목적에 따라 해당 역할을 담당하는 운영자에게 부여

## 11.2.3 하드웨어 보호를 위해 사용되는 방법

- 사용자 프로세스가 불법적인 명령을 수행하거나 허락되지 않은 메모리에 접근하는 등 오류가 발생
- 예외 처리를 위해 프로세스를 잠시 중단시키고 해당 오류를 처리하는 운영체제 루틴을 호출
    - 트랩 또는 인터럽트를 이용

1. **트랩**
    - 인터럽트처럼 **인터럽트 벡터를 통해 제어**를 운영체제에 넘김
2. **이중 모드 연산**
    - 오동작하는 프로그램으로부터 운영체제와 다른 프로그램의 자료를 보호
    - 모드 비트를 이용하여 사용자 모드와 커널 모드 구분
        - 대부분의 경우 프로세스는 사용자 모드에서 수행
    - 커널 모드 : 특권명령 수행 가능
        - 특권 명령 : 시스템의 상태를 바꾸어 보안에 위험을 줄 수 있는 명령
    - 사용자 모드에서 특권 명령을 사용하려고 하면 트랩 발생
3. 메모리 보호
    - 각 프로세스가 가지는 주소 공간은 서로 분리
    - 2개의 레지스터 이용
        - 기준 레지스터 : 프로세스가 접근할 수 있는 물리적 주소의 최솟값
        - 한계 레지스터 : 프로세스가 접근할 수 있는 주소 범위의 길이
    - 기준 레지스터와 한계 레지스터로 프로그램이 접근할 수 있는 주소의 범위를 지정
    - 범위를 벗어나면 트랩 발생
    - 운영체제가 사용하는 메모리 영역을 사용자 프로세스가 접근하려는 경우 트랩 발생
4. CPU 보호
    - 무한 루프에 빠진 프로세스가 CPU를 독점하는 것을 막음
    - 타이머 : 주기적으로 인터럽트를 발생시키는 장치
    - 프로세스가 자신에게 할당된 시간을 다 쓰면 대기하고 있는 다른 프로세스로 제어를 옮김(RR 스케줄링과 유사한 방식으로 돌아간다고 할 수 있겠다)
    - 타이머를 이용하여 미리 설정된 시간 이후 인터럽트를 발생
5. 입출력 보호
    - 한 프로세스의 입출력에 다른 프로세스가 영향을 미치면 안됨
    - 입출력은 커널 모드에서 동작

## 11.2.4 암호화

1. 암호
    - 암호화 : 인가되지 않은 것들에 대해서는 **정보 접근을 제한**하기 위해 정보를 변형시키는 과정
    - 복호화 : **암호화된 정보**를 다시 **알기 쉽게 하기 위한 변형** 과정
    - 키 : 암호화된 결과를 만들거나 암호화된 정보를 해독하기 위한 알고리즘에 사용
2. 암호 형태
    - 블록 암호 : 평문을 일정 길이의 블록 단위로 잘라서 암호화하는 방식
    - 스트림 암호 : 문자 혹은 비트 단위로 암호화하는 방식
3. 비밀키 암호
    - 암호화 키와 복호화 키가 동일
    - 비밀키를 아는 사람만 암호화와 복호화 가능
    - 키는 공개하지 않음
    - 공개키 암호 알고리즘보다 속도가 빠름
    - 키 공유 문제
4. 공개키 암호
    - 암호화 키(공개키)와 복호화 키(개인키)가 서로 다름
    - 공개키는 누구에게나 공개하지만, 개인키는 공개하지 않음
    - 공개키를 이용하여 비밀키 생성
    - 두 사람이 비밀리에 키를 교환할 필요가 없음
    - 전자서명에 응용
    - 비밀키 공유에 활용
5. 전자서명
    - 공개키 암호의 응용
    - 개인키로 서명, 공개키로 서명을 확인

## 11.3 운영체제 보안 모델

1. **참조 모니터 모델**
    - **프로세스(주체)와 파일(객체)의 정보 흐름을 감시**하는 보안 모델
    - 참조 모니터는 **주체와 객체의 접근 권한을 정의한 데이터베이스를 참조**함으로 보안 정책을 수행
    - 주체와 객체 사이에서 단순접근의 허용여부만 결정
    - 접근한 객체에 포함된 기밀 정보를 **유포하는 것은 막지 못함**
    - 시스템에서 정보의 **안전한 흐름을 보장할 수 없음**
    
    ![image](https://github.com/myrhymetree/operating-system/assets/94158097/d12edf6a-5908-4b54-b242-a15c1db1bf48)
    
2. 정보 흐름 모델
    - 정보의 흐름에 대한 제어 문제를 해결하기 위하여 수학적인 개념에 기반한 모델
    - 정보의 유형에 따라 정보가 흐르는 방향을 제어하는 모델
    - **벨-라파듈라** 모델 : **상위 보안 수준에서 하위 보안 수준**으로 정보가 흐르는 것을 방지하는 것에 관심\
        - 기밀성 유지에 초점
        - 무결성이 깨질 수 있음
      
        ![image](https://github.com/myrhymetree/operating-system/assets/94158097/4d5f2810-1cad-420c-a857-fad146d46b18)

    - **비바** 모델 : **하위 보안 수준에서 상위 보안 수준**으로 정보가 흐르는 것을 방지하는 것에 관심
        - 무결성을 보장하기 위한 모델
        - 권한이 없는 주체가 데이터를 수정하는 것을 막음
        - 권한이 없는 주체가 수정한 데이터를 사용하지 못하게 막음
        
        ![image](https://github.com/myrhymetree/operating-system/assets/94158097/9a1ce51a-3ea7-41d3-8ee1-3215fb58efed)
        

## 11.4 보안 커널

1. 보안 커널
    - 기존의 운영체제 커널에 보안 기능을 통합시킨 것
        - 자주 수행되고 중요한 일을 커널에 둠
    - 안전한 운영체제 : 운영체제상에 내재된 보안상의 결함으로 인하여 발생 가능한 각종 해킹으로부터 시스템을 보호하기 위하여 보안 커널을 이식한 운영체제
    - 보안 커널을 사용한 운영체제는 보안 기능 요소를 갖추어야 함
        - 사용자에 대한 식별 및 인증, 접근 제어, 객체 보호, 침입 탐지 등
    - TCB의 하드웨어, 펌웨어, 소프트웨어 요소
    - 시스템 호출을 통해 보안 경계를 통과
    - 일반 사용자는 보안 경계를 넘을 수 없음
   
    ![image](https://github.com/myrhymetree/operating-system/assets/94158097/d2c8c2a4-2d6f-4285-9e1f-901d7f128541)
    
2. TCB(Trusted Computing Base)
    - 컴퓨터 시스템의 보안을 구성하는 핵심요소들의 집합
        - 정상적으로 동작하지 않을 경우 시스템 보안에 문제가 생길 수 있는 하드웨어, 펌웨어, 소프트웨어, 물리적 설치장소, 보안정책 등의 집합
    - 참조 모니터를 구현한 형태
        - 운영체제의 기본적인 작업에 대한 보안성 및 무결성을 감지
